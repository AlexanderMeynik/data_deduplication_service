# Сервис дедупликации данных

Цель работы состоит в реализации системы оптимального хранения
данных за счет использования подхода дедупликации данных и проведении
тестирования для измерения производительности созданного прототипа.

## Задачи

- [x] решить проблему с подключением к бд
- [x] создать простую схему для дедупликации
- [ ] Доработать данную схему базы данных
    - [x] Добавить методы для сбора метрик(процент сжатия, распределение по числу блоков)
    - [x] Убрать ненужные/избыточные колонки, нормализовать/уточнить взаимосвязи между таблицами
    - [x] добавить методы блочной передачи, чтобы передавать не сразу весь файл, а по фрагментам
    - [x] Реализовать процедуры удаления файлов из бд
- [x] реализовать создание схемы выше в разных вариантах(размер сегмента, функция хэширования) при помощи динамических
  sql запросов
    - [x] Реализовать процедуру создания базы данных
    - [x] Реализовать процедуру заполнения схем новой бд
    - [x] добавить возможность выбирать функцию хэширования
- [ ] добавить источник данных
    - [x] Источник данных директория(любая)
    - [ ] Подобрать данные для проверки работы сервиса
- [x] реализовать сервис для сбора данных из директорий/архивов и их восстановления, внутри будет использован dbService
    - [x] Доработать набор запросов для взаимодействия с файлами/директориями
    - [x] Доделать реализации для стратегий работы с бд
    - [x] Использовать более безопасный вариант подлючения к бд
        - [x] Подключения и все связанные с ним ресурсы должны быть освобождены после заврешеняи рабоыт программы
        - [x] Незавершённые транзакции должны быть отменены/завершены
- [x] определить стек технологий
    - [ ] Доработать стек ниже
- [x] Ужать логи для запросов, стандартизировать их содержимое
    - [x] Ввести единое соответствие между кодами возврата и типом ошибки
    - [x] Убрать лишние(\n,\r\n ...) символы из записей логгера
    - [x] Создать [конфигурацию](https://rpg.ifi.uzh.ch/docs/glog.html) для логов
    - [x] Убрать тексты запросов из записей
- [x] Произвести миграцию со старой версии libpqxx на новую
- [ ] Тестирование
  - [x] Собрать и установить gtest/gmock 
  - [x] создать конфигурации для тестирования
  - [x] CI/CD
  - [x] Сохранять логи в качестве артефактов
  - [ ] Исправить основные issue в репозитории
- [ ] ввести набор критериев и метрик, зависимости между которыми будут подлежать исследованию

## Стек технологий

1. C++ 20
2. libpqxx 7.9
3. libglog
4. gtest/gmock 1.15.2
5. FFF(Fake Function Framework)
6. libopenssl

## Wsl firewall set-up

[source](https://stackoverflow.com/questions/56824788/how-to-connect-to-windows-postgres-database-from-wsl)
