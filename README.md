# Сервис дедупликации данных

Цель работы состоит в реализации системы оптимального хранения
данных за счет использования подхода дедупликации данных и проведении
тестирования для измерения производительности созданного прототипа.

## Описание проекта

Данный проект выполнялся в рамках курсовой работы по дисциплине "Системы анализа больших данных".
Основные работы над данной частью проекта производились с сентября по ноябрь 2024 года.
Целью всего проекта является сбор и анализ метаданных статей с платформы 

[Основная страница с документацией](doc%2FREADME.md)

[Документация doxygen](https://alexandermeynik.github.io/data_deduplication_service/index.html)

## Стек технологий
1. C++ 20
2. PostgreSQL 15 [сайт](https://www.postgresql.org/about/news/postgresql-15-released-2526/)
3. libpqxx 7.9 [GitHub](https://github.com/jtv/libpqxx)
4. libglog [GitHub](https://github.com/google/glog)
5. gtest/gmock 1.15.2 [GitHub](https://github.com/google/googletest)
6. FFF(Fake Function Framework) [GitHub](https://github.com/meekrosoft/fff)
7. libssl [сайт](https://packages.debian.org/ru/sid/libssl-dev)
8. Асинхронный пул потоков из библиотеки Leopard [GitHub](https://github.com/hosseinmoein/Leopard)
9. Qt6 Widgets [сайт](https://www.qt.io/product/qt6)
10. Docker 27.1 [сайт](https://www.docker.com/)
11. Doxygen [сайт](https://www.doxygen.nl/)

## Описание провдимых мероприятий

1. Реализован механизм runtime преобразования PostgreSQL типов по значению OID(см. [models.h](https://alexandermeynik.github.io/data_deduplication_service/classmodels_1_1myPxxxModelBase.html));
2. Применён Model/View подход для [визуализации данных](doc%2FimplementationDetails.md#особенности-представления-данных);
3. Реализован набор [workflow](doc%2Fworkflows.md) для сборки проекта, тестирования, временных измерений и равёртывания документации;
4. Были изучены особенности написания документации на базе Doxygen.
5. Применены подходы блочной вставки и [потоковых запросов](doc%2FimplementationDetails.md#загрузка-файла-в-систему)
для ускорения вставки файла в БД.
6. Создан docker образ и [workflow](https://github.com/AlexanderMeynik/data_deduplication_service/actions/workflows/docker_build.yml)
для сборки данного образа и отправки его в HUB.
7. Разработан потокобезпоасный [шаблонный класс](https://alexandermeynik.github.io/data_deduplication_service/classtiming_1_1clockArray.html)
массива таймеров для сбора временных метрик.
8. Произведено smoke [тестирование](doc%2Ftesting.md) полученной реализации таймера и сервисов работы с файлами;


## Задачи
- [x] решить проблему с подключением к бд
- [x] создать простую схему для дедупликации
- [x] Доработать данную схему базы данных
    - [x] Добавить методы для сбора метрик(процент сжатия, распределение по числу блоков)
    - [x] Убрать ненужные/избыточные колонки, нормализовать/уточнить взаимосвязи между таблицами
    - [x] добавить методы блочной передачи, чтобы передавать не сразу весь файл, а по фрагментам
    - [x] Реализовать процедуры удаления файлов из бд
- [x] реализовать создание схемы выше в разных вариантах(размер сегмента, функция хэширования) при помощи динамических
  sql запросов
    - [x] Реализовать процедуру создания базы данных
    - [x] Реализовать процедуру заполнения схем новой бд
    - [x] добавить возможность выбирать функцию хэширования
- [x] добавить источник данных
    - [x] Источник данных директория(любая)
    - [x] Подобрать данные для проверки работы сервиса
- [x] реализовать сервис для сбора данных из директорий/архивов и их восстановления, внутри будет использован dbService
    - [x] Доработать набор запросов для взаимодействия с файлами/директориями
    - [x] Доделать реализации для стратегий работы с бд
    - [x] Использовать более безопасный вариант подлючения к бд
        - [x] Подключения и все связанные с ним ресурсы должны быть освобождены после заврешеняи рабоыт программы
        - [x] Незавершённые транзакции должны быть отменены/завершены
- [x] определить стек технологий
    - [x] Доработать стек ниже
- [x] Ужать логи для запросов, стандартизировать их содержимое
    - [x] Ввести единое соответствие между кодами возврата и типом ошибки
    - [x] Убрать лишние(\n,\r\n ...) символы из записей логгера
    - [x] Создать [конфигурацию](https://rpg.ifi.uzh.ch/docs/glog.html) для логов
    - [x] Убрать тексты запросов из записей
- [x] Произвести миграцию со старой версии libpqxx на новую
- [x] Тестирование
  - [x] Собрать и установить gtest/gmock 
  - [x] создать конфигурации для тестирования
  - [x] CI/CD
  - [x] Сохранять логи в качестве артефактов
- [x] Исправить основные issue в репозитории
- [x] ввести набор критериев и метрик, зависимости между которыми будут подлежать исследованию
- [ ] Создать релиз для приложения
- [ ] Задокументировать тестовые сценарии
